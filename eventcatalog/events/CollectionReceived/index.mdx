---
id: CollectionReceived
name: CollectionReceived
version: '1'
summary: Event CollectionReceived - BioPro System
owners:
    - collections-service
producers:
    - collections-service
consumers: []
---

# CollectionReceivedEvent

**Schema ID**: 4
**Schema Version**: 1
**Subject**: CollectionReceivedEvent
**Domain**: Collections
**Namespace**: com.biopro.events.collections

## Business Context

Event published when a blood collection is received

## Event Schema Fields

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| `unitNumber` | `string` | Yes | Unique identifier for the collection unit (e.g., W036202412345) |
| `status` | `string` | Yes | Current status of the collection |
| `bagType` | `string` | Yes | Type of collection bag used |
| `drawTime` | `timestamp-millis` | Yes | Time when blood was drawn |
| `drawTimeZone` | `string` | No | Timezone for drawTime (e.g., America/New_York) |
| `withdrawalTime` | `timestamp-millis` | Yes | Time when collection was withdrawn/completed |
| `withdrawalTimeZone` | `string` | No | Timezone for withdrawalTime |
| `donationType` | `enum (ALLOGENEIC, AUTOLOGOUS)` | Yes | Type of donation |
| `procedureType` | `string` | Yes | Procedure type used for collection |
| `collectionLocation` | `string` | Yes | Location where collection occurred |
| `aboRh` | `string` | Yes | ABO/Rh blood type (e.g., AP, AN, BP, BN, OP, ON, ABP, ABN) |
| `machineSerialNumber` | `string` | No | Serial number of collection machine (if apheresis) |
| `machineType` | `string` | No | Type of collection machine used |
| `donationProperties` | `map<string, string>` | No | Additional donation-specific properties |
| `drawProperties` | `map<string, string>` | No | Additional draw-specific properties |
| `volumes` | `array<Volume>` | Yes | List of volumes associated with the collection |


## Sample Event

```json
{
  "unitNumber": "W835534375",
  "status": "ACTIVE",
  "bagType": "STANDARD",
  "drawTime": 1763355987125,
  "drawTimeZone": 1763355987125,
  "withdrawalTime": 1763355987125,
  "withdrawalTimeZone": 1763355987125,
  "donationType": "ALLOGENEIC",
  "procedureType": "STANDARD",
  "collectionLocation": "New York Blood Center",
  "aboRh": "AP",
  "donationProperties": {},
  "volumes": [
    {
      "type": "PLASMA",
      "amount": 450,
      "excludeInCalculation": false
    }
  ]
}
```

## Schema Evolution

This event uses Avro schema validation through Confluent Schema Registry.

- **Schema ID**: 4
- **Version**: 1
- **Compatibility**: BACKWARD (default)

## Message Format

Messages are serialized using **Avro** with the schema ID embedded in the message header (magic byte + schema ID).

## Integration Notes

### Consuming This Event

When consuming this event, use the Confluent Avro deserializer which will:
1. Read the schema ID from the message
2. Fetch the schema from the registry (with caching)
3. Deserialize the message using the schema

### Publishing This Event

When publishing this event:
1. Use the Confluent Avro serializer
2. The serializer will register the schema if needed
3. The schema ID will be embedded in each message

## Download Schema

- [Download Avro Schema](./CollectionReceivedEvent.avsc) - Complete Avro schema definition

<NodeGraph />
